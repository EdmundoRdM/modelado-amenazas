{
  "version": "2.4.1",
  "summary": {
    "title": "Modelado-Amenazas",
    "owner": "Guillermo Humberto Vera Amaro",
    "description": "El presente modelo de amenazas corresponde al sitio web de la biblioteca universitaria. Este sistema permite a estudiantes, personal universitario y bibliotecarios realizar funciones como iniciar sesión, buscar libros, y gestionar usuarios. El modelado identifica amenazas potenciales bajo la metodología STRIDE, propone mitigaciones y genera un análisis de riesgo para proteger los activos del sistema.\n",
    "id": 0
  },
  "detail": {
    "contributors": [
      {
        "name": "Edmundo Ramos"
      }
    ],
    "diagrams": [
      {
        "id": 1,
        "title": "DFD Sitio Web Biblioteca Universitaria",
        "diagramType": "STRIDE",
        "placeholder": "New STRIDE diagram description",
        "thumbnail": "./public/content/images/thumbnail.stride.jpg",
        "version": "2.4.1",
        "cells": [
          {
            "position": {
              "x": 50,
              "y": 70
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Usuarios"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "2f32a3fa-57a2-4122-87ce-78b0f30e1932"
                },
                {
                  "group": "right",
                  "id": "b3fd309d-27d0-455f-8987-f3f5105f0d36"
                },
                {
                  "group": "bottom",
                  "id": "7479e59c-4d7a-4133-850f-55761c258b0b"
                },
                {
                  "group": "left",
                  "id": "c3b2bf86-b1d4-43e9-8893-1654410127a4"
                }
              ]
            },
            "id": "8438beb1-4573-4759-8e35-7139ad0923e9",
            "zIndex": 1,
            "data": {
              "type": "tm.Actor",
              "name": "Usuarios",
              "description": "Usuarios anónimos o con credenciales válidas que acceden al sitio web.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "providesAuthentication": false,
              "threats": [
                {
                  "id": "f5c7bfe5-bf5b-4fae-b6c2-50cdf5cbdfc3",
                  "title": "Suplantación de identidad ",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Spoofing / Spoofing",
                  "description": "Un atacante podría hacerse pasar por un usuario legítimo (estudiante, personal o bibliotecario) para acceder al sistema web de la biblioteca y obtener privilegios o información no autorizada.",
                  "mitigation": "Implementar autenticación robusta, como son contraseñas fuertes y CAPTCHA´s, cifrado de credenciales en tránsito y en almacenamiento.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 1,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 1,
                "repudiation": 0
              }
            }
          },
          {
            "position": {
              "x": 600,
              "y": 60
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Bibliotecario"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "2f32a3fa-57a2-4122-87ce-78b0f30e1932"
                },
                {
                  "group": "right",
                  "id": "b3fd309d-27d0-455f-8987-f3f5105f0d36"
                },
                {
                  "group": "bottom",
                  "id": "7479e59c-4d7a-4133-850f-55761c258b0b"
                },
                {
                  "group": "left",
                  "id": "c3b2bf86-b1d4-43e9-8893-1654410127a4"
                }
              ]
            },
            "id": "b2f64ed1-7739-4762-b2db-a66e03b5a2d6",
            "zIndex": 2,
            "data": {
              "type": "tm.Actor",
              "name": "Bibliotecario",
              "description": "Usuario privilegiado que puede agregar libros y usuarios.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "providesAuthentication": false,
              "threats": [
                {
                  "id": "f055c105-00ad-44f3-ba03-bb5e777c18cb",
                  "title": "Suplantación de identidad",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Spoofing / Spoofing",
                  "description": "Un atacante podría hacerse pasar por un usuario legítimo (estudiante, personal o bibliotecario) para acceder al sistema web de la biblioteca y obtener privilegios o información no autorizada.",
                  "mitigation": "Implementar autenticación robusta, como son contraseñas fuertes y CAPTCHA´s, cifrado de credenciales en tránsito y en almacenamiento.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 2,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 2,
                "repudiation": 0
              }
            }
          },
          {
            "position": {
              "x": 380,
              "y": 250
            },
            "size": {
              "width": 60,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Sitio Web \nBiblioteca \nUniversitaria"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "8fba8ba6-455c-405e-ae49-3d0c0a7880fb"
                },
                {
                  "group": "right",
                  "id": "4103d43f-30fe-48b2-910f-31c1fac15526"
                },
                {
                  "group": "bottom",
                  "id": "02e29bb7-2af1-4910-9435-cf277fa091c3"
                },
                {
                  "group": "left",
                  "id": "903b0265-2553-41d2-b055-9f08d8026dbd"
                }
              ]
            },
            "id": "d0b09a31-f6a8-4672-820b-dc92a9c87309",
            "zIndex": 3,
            "data": {
              "type": "tm.Process",
              "name": "Sitio Web \nBiblioteca \nUniversitaria",
              "description": "Plataforma alojada en servidor Linux con Apache, sirve contenido web.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "acda9c4b-d261-4eeb-8174-7606dbc34a3e",
                  "title": "Denegación de servicio",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service / Denegación de servicio",
                  "description": "Un atacante puede saturar el servidor web enviando múltiples peticiones simultáneas, lo que podría inutilizar el sitio y denegar el acceso a usuarios legítimos.",
                  "mitigation": "Aplicar balanceo de carga, detección de tráfico sospechoso por IP, uso de firewalls con reglas de tasa.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 5,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 0,
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 0,
                "denialOfService": 1,
                "elevationOfPrivilege": 0
              }
            }
          },
          {
            "position": {
              "x": 46.25,
              "y": 370
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Páginas Web en Disco"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "830a4b2f-43c8-4ad2-8140-77f274467364"
                },
                {
                  "group": "right",
                  "id": "7666f812-839a-4a66-b94d-76b58141c1db"
                },
                {
                  "group": "bottom",
                  "id": "4b6cff5c-5276-4ecf-9dd2-37d51637d221"
                },
                {
                  "group": "left",
                  "id": "0297f71e-cf7f-4376-af65-e9b9447e8274"
                }
              ]
            },
            "id": "b456d0f2-e707-4a9f-82bf-71f2e3b3e774",
            "zIndex": 4,
            "data": {
              "type": "tm.Store",
              "name": "Páginas Web en Disco",
              "description": "Archivos HTML/CSS almacenados en el servidor.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "c8aff843-cf0b-4e40-bbf5-d22ecd4b50aa",
                  "title": "Modificación no autorizada de archivos web",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering / Manipulación",
                  "description": "Un atacante que obtenga acceso al sistema de archivos podría modificar contenido HTML, scripts o estilos, introduciendo código malicioso o manipulando la presentación.",
                  "mitigation": "Restringir permisos de escritura a administradores, monitorear integridad de archivos, y aplicar listas blancas de acceso.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 6,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "repudiation": 0,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            }
          },
          {
            "position": {
              "x": 350,
              "y": 490
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Web Application Config"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "830a4b2f-43c8-4ad2-8140-77f274467364"
                },
                {
                  "group": "right",
                  "id": "7666f812-839a-4a66-b94d-76b58141c1db"
                },
                {
                  "group": "bottom",
                  "id": "4b6cff5c-5276-4ecf-9dd2-37d51637d221"
                },
                {
                  "group": "left",
                  "id": "0297f71e-cf7f-4376-af65-e9b9447e8274"
                }
              ]
            },
            "id": "77a5e9f4-09dc-4b20-a4b8-d3a61099f005",
            "zIndex": 5,
            "data": {
              "type": "tm.Store",
              "name": "Web Application Config",
              "description": "Archivos de configuración del sistema web.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "2ab908c7-8823-4de5-acbd-6e8778180a3f",
                  "title": "Exposición de configuración sensible",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure / Brecha de información",
                  "description": "Si un atacante accede a los archivos de configuración del sistema, podría obtener credenciales o manipular la conexión a servicios internos.",
                  "mitigation": "Cifrar credenciales dentro de los archivos de configuración, limitar el acceso físico y lógico a dichos archivos, y aplicar control de versiones seguro.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 7,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            }
          },
          {
            "position": {
              "x": 730,
              "y": 370
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Base de Datos"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "830a4b2f-43c8-4ad2-8140-77f274467364"
                },
                {
                  "group": "right",
                  "id": "7666f812-839a-4a66-b94d-76b58141c1db"
                },
                {
                  "group": "bottom",
                  "id": "4b6cff5c-5276-4ecf-9dd2-37d51637d221"
                },
                {
                  "group": "left",
                  "id": "0297f71e-cf7f-4376-af65-e9b9447e8274"
                }
              ]
            },
            "id": "f3b94aee-9bff-4253-8dfc-8947bf9ba4c6",
            "zIndex": 6,
            "data": {
              "type": "tm.Store",
              "name": "Base de Datos",
              "description": "Base de datos MySQL con información de usuarios y libros.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "c7aefad8-cf7e-4a7b-8e45-61df6755db1f",
                  "title": "Acceso no autorizado a la base de datos",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure / Brecha de información",
                  "description": "Un atacante podría ejecutar consultas directas a la base de datos para obtener información confidencial.",
                  "mitigation": "Requerir autenticación para todas las consultas y limitar accesos por rol y origen IP.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 9,
                  "score": ""
                },
                {
                  "id": "c3dd8a66-8d2d-445b-943b-dff29c67b453",
                  "title": "Robo de credenciales de base de datos",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure / Brecha de información",
                  "description": "Las credenciales almacenadas o transmitidas sin cifrado pueden ser robadas por un atacante y usadas para consultas no autorizadas",
                  "mitigation": "Cifrar credenciales en configuración, restringir acceso a IPs de backend y usar roles mínimos necesarios.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 10,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 2,
                "denialOfService": 0
              }
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Web Response",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "1bec977f-dad7-4200-b006-2148a3c208d9",
                  "title": "Divulgación de información sensible",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure / Brecha de información",
                  "description": "Si no hay cifrado, podrían filtrarse datos confidenciales como resultados de búsqueda o mensajes de error.",
                  "mitigation": "HTTPS obligatorio, contenido controlado, sin datos sensibles en mensajes.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 13,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "labels": [
              "Web Response"
            ],
            "id": "4fd9bf2b-db5a-4698-996d-eb311b777c4f",
            "source": {
              "cell": "d0b09a31-f6a8-4672-820b-dc92a9c87309",
              "port": "903b0265-2553-41d2-b055-9f08d8026dbd"
            },
            "target": {
              "cell": "8438beb1-4573-4759-8e35-7139ad0923e9",
              "port": "7479e59c-4d7a-4133-850f-55761c258b0b"
            },
            "vertices": [
              {
                "x": 170,
                "y": 280
              },
              {
                "x": 106,
                "y": 220
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Web app query",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "f2ae89f9-0e5e-4543-add9-7754cd0b0b1e",
                  "title": "Consulta interceptada o expuesta",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure / Brecha de información",
                  "description": "Las consultas mal protegidas podrían revelar parámetros internos o credenciales.",
                  "mitigation": "Uso de red privada, cifrado en tránsito, sanitización de parámetros.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 15,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "labels": [
              "Web app query"
            ],
            "id": "9de5ce4e-a32c-4f57-a1dc-7b9ae30f79ed",
            "source": {
              "cell": "d0b09a31-f6a8-4672-820b-dc92a9c87309",
              "port": "02e29bb7-2af1-4910-9435-cf277fa091c3"
            },
            "target": {
              "cell": "f3b94aee-9bff-4253-8dfc-8947bf9ba4c6",
              "port": "0297f71e-cf7f-4376-af65-e9b9447e8274"
            },
            "vertices": [
              {
                "x": 580,
                "y": 400
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Web Request",
              "description": "Solicitudes de los usuarios (consultas, login, navegación) enviadas al sitio.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "fed1d723-f61f-4584-a4d6-345d5f790592",
                  "title": "Interceptación de datos (Man-in-the-middle)",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure / Brecha de información",
                  "description": "Las solicitudes de los usuarios podrían ser interceptadas si no se usa HTTPS.",
                  "mitigation": "Forzar uso de HTTPS. Deshabilitar HTTP. Usar certificados válidos.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 11,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "labels": [
              "Web Request"
            ],
            "id": "5efd19ef-16a3-442f-810c-11dc1ae865c2",
            "source": {
              "cell": "8438beb1-4573-4759-8e35-7139ad0923e9",
              "port": "b3fd309d-27d0-455f-8987-f3f5105f0d36"
            },
            "target": {
              "cell": "d0b09a31-f6a8-4672-820b-dc92a9c87309",
              "port": "8fba8ba6-455c-405e-ae49-3d0c0a7880fb"
            },
            "vertices": [
              {
                "x": 270,
                "y": 190
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Web Response",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "2c1d2543-82c9-48f4-be5a-f91479cae4da",
                  "title": "Divulgación de datos administrativos",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering / Manipulación",
                  "description": "Podrían filtrarse configuraciones o información privilegiada provenientes de la respuesta del sistema.",
                  "mitigation": "Cifrado, control de acceso, monitoreo de respuestas.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 14,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            },
            "labels": [
              "Web Response"
            ],
            "id": "3f74d6a6-997e-4dcf-ac5d-752dc3771406",
            "source": {
              "cell": "d0b09a31-f6a8-4672-820b-dc92a9c87309",
              "port": "8fba8ba6-455c-405e-ae49-3d0c0a7880fb"
            },
            "target": {
              "cell": "b2f64ed1-7739-4762-b2db-a66e03b5a2d6",
              "port": "c3b2bf86-b1d4-43e9-8893-1654410127a4"
            },
            "vertices": [
              {
                "x": 520,
                "y": 210
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Web Request",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "aa66e2e1-0eda-4162-b193-a05bd9bf02e7",
                  "title": "Interceptación de solicitudes administrativas",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure / Brecha de información",
                  "description": "Un atacante podría interceptar solicitudes con privilegios, como creación de usuarios.",
                  "mitigation": "Forzar HTTPS, autenticación de bibliotecario, cifrado en tránsito.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 12,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "labels": [
              "Web Request"
            ],
            "id": "4fc2f58f-8056-42a5-b8da-b4f1cbfdd054",
            "source": {
              "cell": "b2f64ed1-7739-4762-b2db-a66e03b5a2d6",
              "port": "7479e59c-4d7a-4133-850f-55761c258b0b"
            },
            "target": {
              "cell": "d0b09a31-f6a8-4672-820b-dc92a9c87309",
              "port": "4103d43f-30fe-48b2-910f-31c1fac15526"
            },
            "vertices": [
              {
                "x": 630,
                "y": 260
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Querys",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "a65047be-8300-4cc2-b5b1-5710257f068e",
                  "title": "Inyección SQL",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering / Manipulación",
                  "description": "Parámetros manipulados podrían alterar el comportamiento de las consultas.",
                  "mitigation": "Uso de sentencias preparadas y validación estricta.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 16,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            },
            "labels": [
              "Querys"
            ],
            "id": "be3e8269-6f21-4a2b-b0b1-4a15ae783025",
            "source": {
              "cell": "d0b09a31-f6a8-4672-820b-dc92a9c87309",
              "port": "02e29bb7-2af1-4910-9435-cf277fa091c3"
            },
            "target": {
              "cell": "f3b94aee-9bff-4253-8dfc-8947bf9ba4c6",
              "port": "0297f71e-cf7f-4376-af65-e9b9447e8274"
            },
            "vertices": [
              {
                "x": 580,
                "y": 360
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Respuesta BD",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "042d1d1c-2739-400a-928d-03621176277c",
                  "title": "Respuesta interceptada o sensible",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure / Brecha de información",
                  "description": "El contenido que regresa puede contener información personal o confidencial.",
                  "mitigation": "Red privada, acceso autenticado, cifrado de datos sensibles.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 17,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "labels": [
              "Respuesta BD"
            ],
            "id": "8e40b2c5-4b73-4cad-bc7e-a1852f92019f",
            "source": {
              "cell": "f3b94aee-9bff-4253-8dfc-8947bf9ba4c6",
              "port": "830a4b2f-43c8-4ad2-8140-77f274467364"
            },
            "target": {
              "cell": "d0b09a31-f6a8-4672-820b-dc92a9c87309",
              "port": "02e29bb7-2af1-4910-9435-cf277fa091c3"
            },
            "vertices": [
              {
                "x": 630,
                "y": 330
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Consulta a paginas\nWeb en disco",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "526b7107-28fd-42ab-8ab4-1d3dce8be532",
                  "title": "Modificación de archivos estáticos",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering / Manipulación",
                  "description": "Un atacante podría modificar el contenido de las páginas para insertar malware o alterar el sitio.",
                  "mitigation": "Solo lectura, control de integridad, acceso solo a administradores.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 19,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            },
            "labels": [
              "Consulta a paginas\nWeb en disco"
            ],
            "id": "d4816a71-8769-4147-bce1-9e5ce35f5e85",
            "source": {
              "cell": "d0b09a31-f6a8-4672-820b-dc92a9c87309",
              "port": "02e29bb7-2af1-4910-9435-cf277fa091c3"
            },
            "target": {
              "cell": "b456d0f2-e707-4a9f-82bf-71f2e3b3e774",
              "port": "7666f812-839a-4a66-b94d-76b58141c1db"
            },
            "vertices": []
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Lee app config",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "9aee1b06-e439-47d9-bb14-64285c03ccd7",
                  "title": "Exposición de configuración",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure / Brecha de información",
                  "description": "Si se accede a archivos de configuración, se podrían extraer claves o credenciales",
                  "mitigation": "Cifrado de configuración, acceso restringido, escaneo de seguridad.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 20,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "labels": [
              "Lee app config"
            ],
            "id": "8214d54b-b91e-494d-a01a-a2a4bf5cfaff",
            "source": {
              "cell": "d0b09a31-f6a8-4672-820b-dc92a9c87309",
              "port": "02e29bb7-2af1-4910-9435-cf277fa091c3"
            },
            "target": {
              "cell": "77a5e9f4-09dc-4b20-a4b8-d3a61099f005",
              "port": "830a4b2f-43c8-4ad2-8140-77f274467364"
            },
            "vertices": []
          }
        ],
        "description": "Este diagrama muestra cómo fluyen los datos en el sistema principal del sitio web de la biblioteca universitaria, incluyendo los actores (usuarios, bibliotecarios), el sitio web como proceso central, la base de datos, y las comunicaciones de entrada y salida."
      },
      {
        "id": 2,
        "title": "DFD LogIn",
        "diagramType": "STRIDE",
        "placeholder": "New STRIDE diagram description",
        "thumbnail": "./public/content/images/thumbnail.stride.jpg",
        "version": "2.4.1",
        "cells": [
          {
            "position": {
              "x": 160,
              "y": 220
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Usuarios"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "297c7daa-6617-4672-9a70-1fd2e875e80d"
                },
                {
                  "group": "right",
                  "id": "32eab468-c620-439c-8f3c-f42bfac4fc7d"
                },
                {
                  "group": "bottom",
                  "id": "1bd5097b-a3b8-4942-b5c0-c27151b4f8fb"
                },
                {
                  "group": "left",
                  "id": "42dfec21-c233-497c-b788-44920e86e328"
                }
              ]
            },
            "id": "dc44144e-0b4d-40ff-836b-3240d3757673",
            "zIndex": 1,
            "data": {
              "type": "tm.Actor",
              "name": "Usuarios",
              "description": "Estudiantes, personal universitario y bibliotecarios que intentan iniciar sesión en el sistema. Pueden tener credenciales válidas o no.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "providesAuthentication": false,
              "threats": [
                {
                  "id": "cb27497e-bc5c-4b1b-8d1e-c561a78cb952",
                  "title": "Suplantación de identidad",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Spoofing / Spoofing",
                  "description": "Un atacante podría intentar acceder al sistema haciéndose pasar por un usuario legítimo (por ejemplo, adivinando credenciales o reutilizando contraseñas expuestas).",
                  "mitigation": "Implementar autenticación segura, políticas de contraseña robustas, y mecanismos de bloqueo tras múltiples intentos fallidos.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 22,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 1,
                "repudiation": 0
              }
            }
          },
          {
            "position": {
              "x": 501,
              "y": 220
            },
            "size": {
              "width": 60,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Controlador web"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "228b7e56-f1d6-4f26-984f-2af65168e2b6"
                },
                {
                  "group": "right",
                  "id": "22e45fcd-f4da-469f-839b-16a7abc4395e"
                },
                {
                  "group": "bottom",
                  "id": "2e439f17-3e15-49e7-b5d5-7964ec0739df"
                },
                {
                  "group": "left",
                  "id": "1acc0250-a47d-4a4e-9198-bee4fe30dbcb"
                }
              ]
            },
            "id": "2f0a8b4a-efcc-4910-960d-60c6bae5d5d4",
            "zIndex": 2,
            "data": {
              "type": "tm.Process",
              "name": "Controlador web",
              "description": "Recibe las peticiones de los usuarios, valida las credenciales y gestiona el flujo del inicio de sesión.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "321e4b1a-b297-414b-b56c-993262f9a00a",
                  "title": "Denegación de servicio al controlador",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service / Denegación de servicio",
                  "description": "El controlador podría ser objetivo de un ataque de denegación de servicio, en el que múltiples peticiones simultáneas saturan el sistema e impiden el acceso legítimo.",
                  "mitigation": "Usar balanceo de carga, límites de tasa de peticiones por IP, y detección de patrones anómalos de tráfico.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 23,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 0,
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 0,
                "denialOfService": 1,
                "elevationOfPrivilege": 0
              }
            }
          },
          {
            "position": {
              "x": 887,
              "y": 220
            },
            "size": {
              "width": 60,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Proceso de login"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "228b7e56-f1d6-4f26-984f-2af65168e2b6"
                },
                {
                  "group": "right",
                  "id": "22e45fcd-f4da-469f-839b-16a7abc4395e"
                },
                {
                  "group": "bottom",
                  "id": "2e439f17-3e15-49e7-b5d5-7964ec0739df"
                },
                {
                  "group": "left",
                  "id": "1acc0250-a47d-4a4e-9198-bee4fe30dbcb"
                }
              ]
            },
            "id": "7447d538-3ff0-44fd-a58f-ff30fa26a05c",
            "zIndex": 3,
            "data": {
              "type": "tm.Process",
              "name": "Proceso de login",
              "description": "Valida credenciales, maneja la lógica de autenticación, y se comunica con la base de datos.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "cb8794a1-9e30-4086-ab63-f8903cc4de75",
                  "title": "Ataque de fuerza bruta",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Elevation of privilege / Elevación de privilegios",
                  "description": "Un atacante puede probar combinaciones de usuario/contraseña hasta adivinar credenciales válidas y acceder al sistema con privilegios.",
                  "mitigation": "Limitar intentos de login, usar CAPTCHA, y aplicar autenticación multifactor (MFA).",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 24,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 0,
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 0,
                "denialOfService": 0,
                "elevationOfPrivilege": 1
              }
            }
          },
          {
            "position": {
              "x": 273,
              "y": 400
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Páginas web en disco"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "f0c140c4-c269-49bd-9392-8a090653e052"
                },
                {
                  "group": "right",
                  "id": "8d3ec9bd-4ea1-45e2-89c4-2ae898785d5e"
                },
                {
                  "group": "bottom",
                  "id": "8c6969c0-5794-4eff-8261-a0bbe28fe629"
                },
                {
                  "group": "left",
                  "id": "5c0fc0e3-d128-4ce9-81ab-175cf49683e4"
                }
              ]
            },
            "id": "c8a6ca89-f3df-495f-9257-ee428c4988f7",
            "zIndex": 4,
            "data": {
              "type": "tm.Store",
              "name": "Páginas web en disco",
              "description": "Archivos físicos HTML y estáticos que forman parte del sistema de login, como formularios.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "07dbc00c-6059-4689-9fc5-8024e9dc9a48",
                  "title": "Manipulación de páginas de login",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering / Manipulación",
                  "description": "Archivos HTML de las páginas de inicio de sesión pueden ser alterados para capturar credenciales o mostrar información falsa al usuario.",
                  "mitigation": "Configurar acceso solo de lectura para usuarios no administradores, proteger el servidor de archivos, y monitorear integridad de contenido.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 27,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "repudiation": 0,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            }
          },
          {
            "position": {
              "x": 665,
              "y": 400
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Base de datos"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "f0c140c4-c269-49bd-9392-8a090653e052"
                },
                {
                  "group": "right",
                  "id": "8d3ec9bd-4ea1-45e2-89c4-2ae898785d5e"
                },
                {
                  "group": "bottom",
                  "id": "8c6969c0-5794-4eff-8261-a0bbe28fe629"
                },
                {
                  "group": "left",
                  "id": "5c0fc0e3-d128-4ce9-81ab-175cf49683e4"
                }
              ]
            },
            "id": "a6365c33-5c0b-4733-a673-fae30812077b",
            "zIndex": 5,
            "data": {
              "type": "tm.Store",
              "name": "Base de datos",
              "description": "Almacena usuarios, contraseñas, roles y otros datos utilizados durante el proceso de autenticación.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "bb940597-d26e-438e-ab27-c5146aa4397a",
                  "title": "Inyección SQL",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering / Manipulación",
                  "description": "Si los datos ingresados no son correctamente validados, un atacante podría insertar comandos SQL maliciosos y modificar el contenido de la base de datos.",
                  "mitigation": "Usar consultas preparadas (prepared statements), validar y sanear todas las entradas del usuario, y aplicar el principio de privilegio mínimo.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 25,
                  "score": ""
                },
                {
                  "id": "33e904c9-dc4f-48a5-83ee-ed600aac0eba",
                  "title": "Robo de credenciales",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure / Brecha de información",
                  "description": "Si las credenciales se almacenan sin cifrado o son accesibles por otros medios, pueden ser capturadas y reutilizadas por un atacante.",
                  "mitigation": "Cifrar las contraseñas con algoritmos robustos, restringir el acceso por IP a la base de datos y evitar a toda costa credenciales hardcodeadas.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 26,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "repudiation": 0,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Web Request",
              "description": "Peticiones de inicio de sesión enviadas por los usuarios.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Web Request"
            ],
            "id": "160727c3-9d16-4e74-b7e9-3f14b847924b",
            "source": {
              "cell": "dc44144e-0b4d-40ff-836b-3240d3757673",
              "port": "32eab468-c620-439c-8f3c-f42bfac4fc7d"
            },
            "target": {
              "cell": "2f0a8b4a-efcc-4910-960d-60c6bae5d5d4",
              "port": "1acc0250-a47d-4a4e-9198-bee4fe30dbcb"
            },
            "vertices": [
              {
                "x": 390,
                "y": 210
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Web Response",
              "description": "Mensajes de error, confirmación de login o redirección.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Web Response"
            ],
            "id": "2290234d-8a3e-4e9d-b686-5d48a848a495",
            "source": {
              "cell": "2f0a8b4a-efcc-4910-960d-60c6bae5d5d4",
              "port": "1acc0250-a47d-4a4e-9198-bee4fe30dbcb"
            },
            "target": {
              "cell": "dc44144e-0b4d-40ff-836b-3240d3757673",
              "port": "32eab468-c620-439c-8f3c-f42bfac4fc7d"
            },
            "vertices": [
              {
                "x": 380,
                "y": 300
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "UsuarioAutenticado()",
              "description": "Transferencia de credenciales para autenticación.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "UsuarioAutenticado()"
            ],
            "id": "b3106cf1-b2de-4713-a30d-dbee46eeee8d",
            "source": {
              "cell": "2f0a8b4a-efcc-4910-960d-60c6bae5d5d4",
              "port": "22e45fcd-f4da-469f-839b-16a7abc4395e"
            },
            "target": {
              "cell": "7447d538-3ff0-44fd-a58f-ff30fa26a05c",
              "port": "1acc0250-a47d-4a4e-9198-bee4fe30dbcb"
            },
            "vertices": [
              {
                "x": 720,
                "y": 210
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "UsuarioAutenticado_Query",
              "description": "Consulta de validación de usuario y contraseña.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "UsuarioAutenticado_Query"
            ],
            "id": "c8aac9c2-e78f-4bf3-b9fa-6dd7a1bbc16d",
            "source": {
              "cell": "7447d538-3ff0-44fd-a58f-ff30fa26a05c",
              "port": "2e439f17-3e15-49e7-b5d5-7964ec0739df"
            },
            "target": {
              "cell": "a6365c33-5c0b-4733-a673-fae30812077b",
              "port": "f0c140c4-c269-49bd-9392-8a090653e052"
            },
            "vertices": [
              {
                "x": 760,
                "y": 350
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "UsuarioAutenticado_Query\nResultado ",
              "description": "Resultado de la autenticación (válido/no válido).",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "UsuarioAutenticado_Query\nResultado "
            ],
            "id": "48a08461-873d-49b0-9cd0-d04e20783b46",
            "source": {
              "cell": "a6365c33-5c0b-4733-a673-fae30812077b",
              "port": "8d3ec9bd-4ea1-45e2-89c4-2ae898785d5e"
            },
            "target": {
              "cell": "7447d538-3ff0-44fd-a58f-ff30fa26a05c",
              "port": "2e439f17-3e15-49e7-b5d5-7964ec0739df"
            },
            "vertices": [
              {
                "x": 890,
                "y": 400
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "UsuarioAutenticado\nResultado",
              "description": "Resultado final del login (éxito o error).",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "UsuarioAutenticado\nResultado"
            ],
            "id": "2de7fcc9-091a-4869-8eaf-3065aef01e3d",
            "source": {
              "cell": "7447d538-3ff0-44fd-a58f-ff30fa26a05c",
              "port": "1acc0250-a47d-4a4e-9198-bee4fe30dbcb"
            },
            "target": {
              "cell": "2f0a8b4a-efcc-4910-960d-60c6bae5d5d4",
              "port": "22e45fcd-f4da-469f-839b-16a7abc4395e"
            },
            "vertices": [
              {
                "x": 710,
                "y": 290
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Vistas",
              "description": "Lectura de contenido visual para mostrar al usuario.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Vistas"
            ],
            "id": "514b326e-faa2-455e-8d19-0abb998b03c8",
            "source": {
              "cell": "c8a6ca89-f3df-495f-9257-ee428c4988f7",
              "port": "8d3ec9bd-4ea1-45e2-89c4-2ae898785d5e"
            },
            "target": {
              "cell": "2f0a8b4a-efcc-4910-960d-60c6bae5d5d4",
              "port": "2e439f17-3e15-49e7-b5d5-7964ec0739df"
            },
            "vertices": []
          }
        ],
        "description": "Este diagrama muestra el como fluyen los datos en el sistema al momento de que un usuario de identifique al iniciar sesión."
      }
    ],
    "diagramTop": 3,
    "reviewer": "Edmundo Ramos del Moral",
    "threatTop": 27
  }
}